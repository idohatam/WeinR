% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FilterLong.R
\name{FilterLong}
\alias{FilterLong}
\title{Filter long-read sequences using QC metrics (internal)}
\usage{
FilterLong(
  qc_obj,
  MinAvgQS = 20,
  MinLength = 100,
  MaxNumberNs = 2,
  OutFileType = c("fastq"),
  OutDir = ".",
  WriteIntermediate = FALSE,
  KeepIntermediates = FALSE,
  OutSuffix = "filtered"
)
}
\arguments{
\item{qc_obj}{A QC S4 object containing \code{@files} and \code{@metrics}.
This function expects exactly one file in \code{qc_obj@files}.}

\item{MinAvgQS}{Numeric(1). Minimum mean per-read Q-score required to keep a read.}

\item{MinLength}{Integer(1). Minimum read length required to keep a read.}

\item{MaxNumberNs}{Integer(1). Maximum allowed number of \code{N} bases per read.}

\item{OutFileType}{Character vector specifying output format(s) to write when outputs
are written (e.g., \code{"fastq"}). Supported values are \code{"fastq"},
\code{"bam"}, and \code{"fasta"} (as implemented by \code{WriteReadOutputs()}).}

\item{OutDir}{Character(1). Output directory for filtered reads (created if needed).}

\item{WriteIntermediate}{Logical(1). If \code{TRUE}, write an intermediate FASTQ for chaining
and store its path in \code{attr(qc_obj, "._tmp_fastq")}.}

\item{KeepIntermediates}{Logical(1). If \code{TRUE}, write filtered reads to \code{OutDir}
(in the formats requested by \code{OutFileType}) and record written paths in the summary.}

\item{OutSuffix}{Character(1). Suffix appended to the output basename when writing filtered reads.}
}
\value{
The updated \code{qc_obj}. The filter summary is stored in
\code{qc_obj@metadata[[basename(file)]]$filter_summary}. If \code{WriteIntermediate = TRUE},
\code{attr(qc_obj, "._tmp_fastq")} contains the intermediate FASTQ path (or \code{NULL}).
}
\description{
Internal helper that filters reads for a single input file referenced by a QC
object using per-read metrics (mean Q-score, read length, and N-count).
A per-file filter summary is stored in \code{qc_obj@metadata[[basename(file)]]$filter_summary}.
Optionally, an intermediate FASTQ is written for chaining and stored in
\code{attr(qc_obj, "._tmp_fastq")}.
}
\details{
If no reads pass filters, the function issues a warning, records a summary with
\code{reads_after = 0L} and \code{output_paths = character(0)}, and returns without writing outputs.
}
\keyword{internal}
