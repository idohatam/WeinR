% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TrimLong.R
\name{TrimLong}
\alias{TrimLong}
\title{Trim reads from the start and/or end (internal)}
\usage{
TrimLong(
  qc_obj,
  Start = NULL,
  End = NULL,
  FilePath = NULL,
  OutDir = ".",
  OutFileType = c("fastq"),
  OutSuffix = "trimmed"
)
}
\arguments{
\item{qc_obj}{A QC S4 object containing \code{@files}. This function expects
exactly one file in \code{qc_obj@files} (the "original" file key for metadata).}

\item{Start}{Integer(1) or \code{NULL}. Number of bases to remove from the start
(5') of each read. If \code{NULL}, no start trimming is applied.}

\item{End}{Integer(1) or \code{NULL}. Number of bases to remove from the end
(3') of each read. If \code{NULL}, no end trimming is applied.}

\item{FilePath}{Character(1) or \code{NULL}. Optional file path to trim. If
\code{NULL}, uses the first file in \code{qc_obj@files}. This allows trimming of
intermediate files while still recording results under the original input file.}

\item{OutDir}{Character(1). Output directory. Created if it does not exist.}

\item{OutFileType}{Character vector specifying output format(s). Supported values
are \code{"fastq"}, \code{"fasta"}, and \code{"bam"} (as implemented by
\code{WriteReadOutputs()}). Multiple formats may be requested.}

\item{OutSuffix}{Character(1). Suffix appended to the output basename when writing
trimmed reads (e.g., \code{"trimmed"}).}
}
\value{
The updated \code{qc_obj}. A trim summary is stored in
\code{qc_obj@metadata[[basename(original_file)]]$trim_summary}.
}
\description{
Internal helper that trims reads for a single input file using \code{Start} and/or
\code{End} offsets and writes trimmed reads to disk. A trim summary is stored in
\code{qc_obj@metadata[[basename(original_file)]]$trim_summary}.
}
\details{
Edge-case behavior:
\itemize{
\item Warns if trimming removes \code{>= 50\%} of reads.
\item Warns if \code{0} reads remain after trimming; no files are written.
}

Trimming is performed using \code{IRanges::narrow()}. Reads that would become
invalid (\code{end < start}) are dropped before trimming. If \code{0} reads remain,
a warning is issued, the summary is recorded with \code{reads_after = 0L}, and no
output files are written.
}
\keyword{internal}
