% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RemoveAdapter.R
\name{RemoveAdapter}
\alias{RemoveAdapter}
\title{Trim adapters and split chimeric reads (internal)}
\usage{
RemoveAdapter(
  qc_obj,
  adapterSeq,
  MaxMismatchEnd = 3,
  MinOverlapEnd = 20,
  MinInternalDistance = 100,
  MinFragmentLength = 200,
  FilePath = NULL,
  OutDir = ".",
  OutFileType = c("fastq"),
  verbose = TRUE,
  WriteIntermediate = FALSE,
  KeepIntermediates = FALSE,
  OutSuffix = "adaptertrimmed"
)
}
\arguments{
\item{qc_obj}{A \code{LongReadQC} (or compatible) object containing exactly one
file in \code{@files}. This function operates on a single file at a time.}

\item{adapterSeq}{Character(1). Adapter sequence (DNA alphabet) to search for.}

\item{MaxMismatchEnd}{Integer(1). Maximum mismatches allowed when matching the
adapter sequence during end-adapter detection.}

\item{MinOverlapEnd}{Integer(1). Maximum distance from either end (5' or 3')
within which an adapter hit is treated as an end adapter and trimmed.}

\item{MinInternalDistance}{Integer(1). Minimum distance from either end required
for an adapter hit to be considered internal (used for chimera splitting).}

\item{MinFragmentLength}{Integer(1). Minimum fragment length to keep after
trimming/splitting. Fragments shorter than this are discarded.}

\item{FilePath}{Character(1) or \code{NULL}. Optional file path to trim. If
\code{NULL}, uses the file in \code{qc_obj@files[[1]]}. This supports trimming
of intermediate files while still recording results under the original input file.}

\item{OutDir}{Character(1). Output directory. Created if it does not exist.}

\item{OutFileType}{Character vector specifying output format(s). Supported values
are \code{"fastq"}, \code{"fasta"}, and \code{"bam"} (as implemented by
\code{WriteReadOutputs()}). Multiple formats may be requested.}

\item{verbose}{Logical(1). If \code{TRUE}, prints progress messages.}

\item{WriteIntermediate}{Logical(1). If \code{TRUE}, writes an intermediate FASTQ
file and stores the path in \code{attr(qc_obj, "._tmp_fastq")} for chaining.}

\item{KeepIntermediates}{Logical(1). If \code{TRUE}, writes the processed reads to
\code{OutDir} (in the formats requested by \code{OutFileType}) and records the
written paths in the summary. If \code{FALSE}, no final outputs are written.}

\item{OutSuffix}{Character(1). Suffix appended to the output basename when writing
processed reads (e.g., \code{"adaptertrimmed"}).}
}
\value{
The updated \code{qc_obj}. An adapter trimming summary is stored in
\code{qc_obj@metadata[[basename(original_file)]]$adapter_summary}. If
\code{WriteIntermediate = TRUE}, \code{attr(qc_obj, "._tmp_fastq")} contains the
intermediate FASTQ path (or \code{NULL}).
}
\description{
Internal helper that searches for an adapter sequence within reads from a
single-file QC object, trims adapter occurrences near read ends, and optionally
splits reads with internal adapter hits into fragments (chimeric read handling).
A summary is stored in \code{qc_obj@metadata[[basename(original_file)]]$adapter_summary}.
Optionally, an intermediate FASTQ can be written for chaining and stored in
\code{attr(qc_obj, "._tmp_fastq")}.
}
\details{
Adapter detection uses \code{Biostrings::vmatchPattern()} (both orientations:
adapter and reverse complement) with \code{max.mismatch = MaxMismatchEnd}.
Adapter hits within \code{MinOverlapEnd} of the 5' or 3' ends are treated as end
adapters and trimmed.

Reads with internal adapter hits at least \code{MinInternalDistance} from both ends
can be split into fragments. Fragments shorter than \code{MinFragmentLength} are
discarded. If fragments are produced, corresponding original reads are removed from
the end-trimmed set to avoid duplicates.
}
\keyword{internal}
