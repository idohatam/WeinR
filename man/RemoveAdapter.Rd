% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RemoveAdapter.R
\name{RemoveAdapter}
\alias{RemoveAdapter}
\title{Trim adapters and split chimeric reads (internal)}
\usage{
RemoveAdapter(
  qc_obj,
  adapterSeq,
  MaxMismatchEnd = 3,
  MinOverlapEnd = 20,
  MinInternalDistance = 100,
  MinFragmentLength = 200,
  FilePath = NULL,
  OutDir = ".",
  OutFileType = c("fastq"),
  OutFile = NULL,
  verbose = TRUE,
  WriteIntermediate = FALSE
)
}
\arguments{
\item{qc_obj}{A \code{LongReadQC} (or compatible) object containing exactly one
file in \code{@files}. This function operates on a single file at a time.}

\item{adapterSeq}{Character(1). Adapter sequence (DNA alphabet) to search for.}

\item{MaxMismatchEnd}{Integer(1). Maximum mismatches allowed when matching the
adapter sequence.}

\item{MinOverlapEnd}{Integer(1). Maximum distance from either end (5' or 3')
within which an adapter hit is treated as an end adapter and trimmed.}

\item{MinInternalDistance}{Integer(1). Minimum distance from either end required
for an adapter hit to be considered internal (used for chimera splitting).}

\item{MinFragmentLength}{Integer(1). Minimum fragment length to keep after
trimming/splitting. Fragments shorter than this are discarded.}

\item{FilePath}{Character(1) or \code{NULL}. Optional file path to trim. If
\code{NULL}, uses the file in \code{qc_obj@files[[1]]}. This supports trimming
of intermediate files while still recording results under the original input file.}

\item{OutDir}{Character(1). Output directory. Created if it does not exist.}

\item{OutFileType}{Character vector specifying output format(s). Supported values
are \code{"fastq"}, \code{"fasta"}, and \code{"bam"} (as implemented by
\code{WriteReadOutputs()}). Multiple formats may be requested.}

\item{OutFile}{Character(1) or \code{NULL}. Optional output filename stem used
for naming outputs. If \code{NULL}, naming is based on the original input file.}

\item{verbose}{Logical(1). If \code{TRUE}, prints progress messages.}

\item{WriteIntermediate}{Logical(1). If \code{TRUE}, writes an intermediate FASTQ
file and stores the path in \code{attr(qc_obj, "._tmp_fastq")} for chaining
steps in downstream workflows.}
}
\value{
The updated \code{qc_obj}. An adapter trimming summary is stored in
\code{qc_obj@metadata[[basename(original_file)]]$adapter_summary}.
}
\description{
Internal helper that searches for an adapter sequence within reads from a
single-file QC object, trims adapter occurrences near read ends, and optionally
splits reads with internal adapter hits into fragments (chimeric read handling).
Trimmed reads are written to disk and a summary is stored in
\code{qc_obj@metadata[[basename(original_file)]]}.
}
\details{
Adapter detection uses \code{Biostrings::vmatchPattern()} with
\code{max.mismatch = MaxMismatchEnd}. Adapter hits within \code{MinOverlapEnd}
of the 5' or 3' ends are treated as end adapters and trimmed.

Reads with two or more adapter hits may contain internal adapters. Internal hits
that are at least \code{MinInternalDistance} from both ends are used to split a
read into fragments (chimera handling). Fragments shorter than
\code{MinFragmentLength} are discarded. If chimeric fragments are produced, the
corresponding original reads are removed from the end-trimmed set to avoid
duplicate representation.

The summary is recorded under the original input file (the single file stored in
\code{qc_obj@files[[1]]}), keyed by its basename.
}
\examples{
\dontrun{
qc_obj2 <- RemoveAdapter(
  qc_obj,
  adapterSeq = "AGATCGGAAGAGCACACGTCTGAACTCCAGTCA",
  MaxMismatchEnd = 3,
  MinOverlapEnd = 20,
  MinInternalDistance = 100,
  MinFragmentLength = 200,
  OutDir = tempdir(),
  OutFileType = "fastq",
  verbose = TRUE,
  WriteIntermediate = TRUE
)
}

}
\keyword{internal}
