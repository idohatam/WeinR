% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RemoveAdapter.R
\name{RemoveAdapter}
\alias{RemoveAdapter}
\title{Trim adapters and split chimeric reads (internal)}
\usage{
RemoveAdapter(
  qc_obj,
  adapterSeq,
  MaxMismatchEnd = 3,
  MinOverlapEnd = 20,
  MinInternalDistance = 100,
  MinFragmentLength = 200,
  OutDir = ".",
  OutFileType = c("fastq"),
  OutFile = NULL,
  verbose = TRUE
)
}
\arguments{
\item{qc_obj}{A \code{LongReadQC} (or compatible) object containing exactly one
file in \code{@files}. This function operates on a single file at a time.}

\item{adapterSeq}{Character(1). Adapter sequence (DNA alphabet) to search for.}

\item{MaxMismatchEnd}{Integer(1). Maximum mismatches allowed when matching the
adapter sequence.}

\item{MinOverlapEnd}{Integer(1). Maximum distance from either end (5' or 3')
within which an adapter hit is treated as an end adapter and trimmed.}

\item{MinInternalDistance}{Integer(1). Minimum distance from either end required
for an adapter hit to be considered "internal" (used for chimera splitting).}

\item{MinFragmentLength}{Integer(1). Minimum fragment length to keep after
trimming/splitting.}

\item{OutDir}{Character(1). Output directory. Created if it does not exist.}

\item{OutFileType}{Character vector specifying output format(s). Supported values
are \code{"fastq"}, \code{"fasta"}, and \code{"bam"} (as implemented by
\code{WriteReadOutputs()}). Multiple formats may be requested.}

\item{OutFile}{Character(1) or \code{NULL}. Optional output filename stem used
for naming outputs.}

\item{verbose}{Logical(1). If \code{TRUE}, prints progress messages.}
}
\value{
The updated \code{qc_obj} with \code{$adapter_summary} stored in
\code{qc_obj@metadata[[file]]}.
}
\description{
Internal helper that searches for an adapter sequence within reads from a
single-file QC object, trims adapter occurrences near read ends, and optionally
splits reads with internal adapter hits into fragments (chimeric read handling).
Filtered/trimmed reads are written to disk and a summary is stored in
\code{qc_obj@metadata}.
}
\details{
Adapter detection uses \code{Biostrings::vmatchPattern()} with a mismatch
threshold. Hits within \code{MinOverlapEnd} of read ends are trimmed. Reads with
multiple internal adapter hits can be split into fragments, and fragments shorter
than \code{MinFragmentLength} are discarded.
}
\examples{
\dontrun{
qc_obj2 <- RemoveAdapter(
  qc_obj,
  adapterSeq = "AGATCGGAAGAGCACACGTCTGAACTCCAGTCA",
  MaxMismatchEnd = 3,
  MinOverlapEnd = 20,
  MinInternalDistance = 100,
  MinFragmentLength = 200,
  OutDir = tempdir(),
  OutFileType = "fastq",
  verbose = TRUE
)
}

}
\keyword{internal}
